<!DOCTYPE html>
<html>
<head>
</head>
<body>
<div>#include "Player.h"</div>
<div>#include "Game.h"</div>
<div>#include &lt;algorithm&gt; //for min/max functions</div>
<div></div>
<div>Player::Player(SDL_Texture *tex, double x, double y)</div>
<div>: SpriteExAnimated(tex, x - 50, y - 50, 0, 1, 4, 0.1f)</div>
<div>{</div>
<div></div>
<div>spriteSrcRect = { 0,0,100,100 };</div>
<div>spriteDestRect = { (int)(m_X - 50),(int) (m_Y-50)&nbsp; ,100,100 };</div>
<div>}</div>
<div></div>
<div>Player::~Player()</div>
<div>{</div>
<div>for (int i = 0; i &lt; (int)m_vBullets.size(); i++)</div>
<div>{</div>
<div>delete m_vBullets[i];</div>
<div>m_vBullets[i] = nullptr;</div>
<div>}</div>
<div>m_vBullets.clear();</div>
<div>m_vBullets.shrink_to_fit();</div>
<div></div>
<div>}</div>
<div></div>
<div></div>
<div>void Player::Render()</div>
<div>{</div>
<div>//rendering bullets here</div>
<div>for (int i = 0; i &lt; (int)m_vBullets.size(); i++)</div>
<div>m_vBullets[i]-&gt;Render();</div>
<div></div>
<div>this-&gt;SpriteExAnimated::Render(); //invoke the base class's Render()</div>
<div></div>
<div>}</div>
<div></div>
<div></div>
<div>void Player::SetIdle()</div>
<div>{</div>
<div>spriteSrcRect.y = 0;</div>
<div>m_iFrame = 0;</div>
<div>m_iSprite = 0;</div>
<div>}</div>
<div></div>
<div>void Player::Update()</div>
<div>{</div>
<div>//implement a rotation mechanism</div>
<div></div>
<div>if (Game::Instance()-&gt;KeyDown(SDL_SCANCODE_A))</div>
<div>angle -= 6.0;</div>
<div>else if (Game::Instance()-&gt;KeyDown(SDL_SCANCODE_D))</div>
<div>angle += 6.0;</div>
<div></div>
<div>this-&gt;UpdatePlayer();</div>
<div>this-&gt;UpdateBullets();</div>
<div>}</div>
<div></div>
<div></div>
<div>void Player::MoveForward()</div>
<div>{</div>
<div>//converting the player spaceship's angle to deltaX and deltaY&nbsp;</div>
<div>m_DX = (float)cos((angle - 90) * M_PI / 180);</div>
<div>m_DY = (float)sin((angle - 90) * M_PI / 180);</div>
<div></div>
<div>//update the velocities</div>
<div>m_velX += m_DX * m_dSpeed;</div>
<div>m_velY += m_DY * m_dSpeed;</div>
<div></div>
<div>//clamp the velocities. and need to maintain previous vector i.e. dx and dy</div>
<div></div>
<div>m_velX = min( max(m_velX, - (m_velMax * fabs(m_DX))) ,&nbsp; (m_velMax * fabs(m_DX))&nbsp; &nbsp;);</div>
<div>m_velY = min(max(m_velY, -(m_velMax * fabs(m_DY))), (m_velMax * fabs(m_DY)));</div>
<div>}</div>
<div></div>
<div>void Player::UpdatePlayer()</div>
<div>{</div>
<div>if (Game::Instance()-&gt;KeyDown(SDL_SCANCODE_W))</div>
<div>{</div>
<div>spriteSrcRect.y = 100;//set y to the 100 so that we start playing the 2nd row</div>
<div>this-&gt;Animate();</div>
<div></div>
<div>this-&gt;MoveForward();</div>
<div></div>
<div>}</div>
<div>else</div>
<div>{</div>
<div>//add some drag to slow down&nbsp;</div>
<div>m_velX *= 0.975;</div>
<div>m_velY *= 0.975;</div>
<div></div>
<div>}</div>
<div></div>
<div>m_X += m_velX; //update x coord</div>
<div>m_Y += m_velY;&nbsp; //update y coord</div>
<div>this-&gt;UpdateDestRect();</div>
<div></div>
<div>spriteSrcRect.x = spriteSrcRect.w* m_iSprite; //updates the animation</div>
<div></div>
<div>}</div>
<div></div>
<div></div>
<div>void Player::UpdateBullets()</div>
<div>{</div>
<div>for (int i = 0; i &lt; (int)m_vBullets.size(); i++)</div>
<div>{</div>
<div>m_vBullets[i]-&gt;Update();</div>
<div></div>
<div>if (m_vBullets[i]-&gt;m_X &lt; 0 || m_vBullets[i]-&gt;m_X &gt;</div>
<div>1024 ||</div>
<div>m_vBullets[i]-&gt;m_Y &lt; 0 || m_vBullets[i]-&gt;m_Y &gt; 768)</div>
<div>{</div>
<div>delete m_vBullets[i];</div>
<div>m_vBullets[i] = nullptr;</div>
<div>m_vBullets.erase(m_vBullets.begin() + i);</div>
<div></div>
<div></div>
<div></div>
<div>}</div>
<div></div>
<div>}</div>
<div></div>
<div>m_vBullets.shrink_to_fit();</div>
<div></div>
<div></div>
<div>}</div>
<div></div>
<div>void Player::SpawnBullet()</div>
<div>{</div>
<div>//converting the player spaceship's angle to deltaX and deltaY&nbsp;</div>
<div>float dx = (float)cos((angle - 90) * M_PI / 180);</div>
<div>float dy = (float)sin((angle - 90) * M_PI / 180);</div>
<div></div>
<div>m_vBullets.push_back(new Bullet(texture, m_X, m_Y, angle, dx, dy));</div>
<div></div>
<div>}</div>
</body>
</html>